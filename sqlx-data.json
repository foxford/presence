{
  "db": "PostgreSQL",
  "1475ac53bb002ec3c7db42824a5711d6bee3a6e288da8fd1adb5d3c749c37660": {
    "describe": {
      "columns": [
        {
          "name": "id: AgentId",
          "ordinal": 0,
          "type_info": {
            "Custom": {
              "kind": {
                "Composite": [
                  [
                    "account_id",
                    {
                      "Custom": {
                        "kind": {
                          "Composite": [
                            [
                              "label",
                              "Text"
                            ],
                            [
                              "audience",
                              "Text"
                            ]
                          ]
                        },
                        "name": "account_id"
                      }
                    }
                  ],
                  [
                    "label",
                    "Text"
                  ]
                ]
              },
              "name": "agent_id"
            }
          }
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Uuid",
          "Int8",
          "Int8"
        ]
      }
    },
    "query": "\n            SELECT\n                agent_id AS \"id: AgentId\"\n            FROM agent_session\n            WHERE\n                classroom_id = $1::uuid\n            LIMIT $2\n            OFFSET $3\n            "
  },
  "1fd36d90b254d655ca41802c550e06a4b9a7ae4d7328605ebef4c3660f2ee965": {
    "describe": {
      "columns": [
        {
          "name": "id: SessionId",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "agent_id: AgentId",
          "ordinal": 1,
          "type_info": {
            "Custom": {
              "kind": {
                "Composite": [
                  [
                    "account_id",
                    {
                      "Custom": {
                        "kind": {
                          "Composite": [
                            [
                              "label",
                              "Text"
                            ],
                            [
                              "audience",
                              "Text"
                            ]
                          ]
                        },
                        "name": "account_id"
                      }
                    }
                  ],
                  [
                    "label",
                    "Text"
                  ]
                ]
              },
              "name": "agent_id"
            }
          }
        },
        {
          "name": "classroom_id: ClassroomId",
          "ordinal": 2,
          "type_info": "Uuid"
        },
        {
          "name": "replica_id",
          "ordinal": 3,
          "type_info": "Text"
        },
        {
          "name": "started_at",
          "ordinal": 4,
          "type_info": "Timestamptz"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          {
            "Custom": {
              "kind": {
                "Composite": [
                  [
                    "account_id",
                    {
                      "Custom": {
                        "kind": {
                          "Composite": [
                            [
                              "label",
                              "Text"
                            ],
                            [
                              "audience",
                              "Text"
                            ]
                          ]
                        },
                        "name": "account_id"
                      }
                    }
                  ],
                  [
                    "label",
                    "Text"
                  ]
                ]
              },
              "name": "agent_id"
            }
          },
          "Uuid",
          "Text",
          "Timestamptz",
          "Bool"
        ]
      }
    },
    "query": "\n            INSERT INTO agent_session\n                (agent_id, classroom_id, replica_id, started_at, outdated)\n            VALUES ($1, $2, $3, $4, $5)\n            RETURNING\n                id AS \"id: SessionId\",\n                agent_id AS \"agent_id: AgentId\",\n                classroom_id AS \"classroom_id: ClassroomId\",\n                replica_id,\n                started_at\n            "
  },
  "2043663b62389d793acd3aee6e4e9765c18bda1ed16480bef9f8bdfe37b12cae": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          "TstzRange"
        ]
      }
    },
    "query": "\n            UPDATE agent_session_history\n            SET lifetime = $2\n            WHERE id = $1\n            "
  },
  "35b166044ea26bd71ebad7be36a97c574a0a213c6ed13568f09b3116f21a83a7": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "UuidArray",
          "Text"
        ]
      }
    },
    "query": "\n            DELETE FROM agent_session\n            WHERE id = ANY ($1)\n            AND replica_id = $2\n            "
  },
  "3817e06bf477ac1b5eee16e51000228d4404d702018dc6ca4336ac39039667e6": {
    "describe": {
      "columns": [
        {
          "name": "agent_id: AgentId",
          "ordinal": 0,
          "type_info": {
            "Custom": {
              "kind": {
                "Composite": [
                  [
                    "account_id",
                    {
                      "Custom": {
                        "kind": {
                          "Composite": [
                            [
                              "label",
                              "Text"
                            ],
                            [
                              "audience",
                              "Text"
                            ]
                          ]
                        },
                        "name": "account_id"
                      }
                    }
                  ],
                  [
                    "label",
                    "Text"
                  ]
                ]
              },
              "name": "agent_id"
            }
          }
        },
        {
          "name": "classroom_id: ClassroomId",
          "ordinal": 1,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Text",
          "Bool"
        ]
      }
    },
    "query": "\n            SELECT\n                agent_id AS \"agent_id: AgentId\",\n                classroom_id AS \"classroom_id: ClassroomId\"\n            FROM agent_session\n            WHERE\n                replica_id = $1\n                AND outdated = $2\n            "
  },
  "3ed067833c47d8c44fad3840301d6d8734bd30603abd196682eabe065e50ae16": {
    "describe": {
      "columns": [
        {
          "name": "classroom_id: ClassroomId",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "count!",
          "ordinal": 1,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        false,
        null
      ],
      "parameters": {
        "Left": [
          "UuidArray"
        ]
      }
    },
    "query": "\n            SELECT\n                classroom_id AS \"classroom_id: ClassroomId\",\n                COUNT(agent_id) AS \"count!\"\n            FROM agent_session\n            WHERE\n                classroom_id = ANY ($1)\n            GROUP BY classroom_id\n            "
  },
  "41b3b699623668f6937fadee9f8f6aa14fa6455330e56e93f003d0c0559d43c0": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Bool",
          "Record",
          "Uuid"
        ]
      }
    },
    "query": "\n            UPDATE agent_session\n            SET outdated = $1\n            WHERE\n                agent_id = $2\n                AND classroom_id = $3\n            "
  },
  "4f8b5eeae54a49d57ca396dde086e18566f98ef97377f55098a934d1497fe44a": {
    "describe": {
      "columns": [
        {
          "name": "id!: SessionId",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "lifetime!",
          "ordinal": 1,
          "type_info": "TstzRange"
        }
      ],
      "nullable": [
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Record",
          "Uuid",
          "Timestamptz"
        ]
      }
    },
    "query": "\n            SELECT\n                id AS \"id!: SessionId\",\n                lifetime AS \"lifetime!\"\n            FROM agent_session_history\n            WHERE\n                agent_id = $1\n                AND classroom_id = $2\n                AND lifetime && tstzrange($3, now())\n            LIMIT 1\n            "
  },
  "748be24f4129ea2a18b635ad5039d8655b33e247ea285829438db1991fce4255": {
    "describe": {
      "columns": [
        {
          "name": "total",
          "ordinal": 0,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        null
      ],
      "parameters": {
        "Left": []
      }
    },
    "query": "\n            SELECT\n                COUNT(*) AS total\n            FROM\n                agent_session_history\n            "
  },
  "8cd09966e7f525b819b5ca275a35257457accc423a06ea03d6f1fc599d00397f": {
    "describe": {
      "columns": [
        {
          "name": "id: SessionId",
          "ordinal": 0,
          "type_info": "Uuid"
        }
      ],
      "nullable": [
        false
      ],
      "parameters": {
        "Left": [
          "Text"
        ]
      }
    },
    "query": "\n            WITH hq AS (\n                SELECT\n                    s.id,\n                    ash.id AS history_id,\n                    tstzrange(lower(ash.lifetime), now()) AS new_lifetime\n                FROM agent_session s\n                    LEFT OUTER JOIN agent_session_history ash\n                        ON ash.agent_id = s.agent_id\n                            AND ash.classroom_id = s.classroom_id\n                            AND ash.lifetime && tstzrange(s.started_at, now())\n                WHERE s.replica_id = $1\n            )\n            UPDATE agent_session_history ash\n            SET lifetime = hq.new_lifetime\n            FROM hq\n            WHERE hq.history_id = ash.id\n            RETURNING hq.id AS \"id: SessionId\"\n            "
  },
  "8e89f39019535066ab8aee48d955bfa336d7b9dd5075ff530acace08855ecb72": {
    "describe": {
      "columns": [],
      "nullable": [],
      "parameters": {
        "Left": [
          "Uuid",
          {
            "Custom": {
              "kind": {
                "Composite": [
                  [
                    "account_id",
                    {
                      "Custom": {
                        "kind": {
                          "Composite": [
                            [
                              "label",
                              "Text"
                            ],
                            [
                              "audience",
                              "Text"
                            ]
                          ]
                        },
                        "name": "account_id"
                      }
                    }
                  ],
                  [
                    "label",
                    "Text"
                  ]
                ]
              },
              "name": "agent_id"
            }
          },
          "Uuid",
          "Timestamptz"
        ]
      }
    },
    "query": "\n            INSERT INTO agent_session_history\n                (id, agent_id, classroom_id, lifetime)\n            VALUES ($1, $2, $3, tstzrange($4, now()))\n            "
  },
  "ac48c91d82b0c301ee231d3a9e0d7adeff8367d1a6c92672307fa931780eb849": {
    "describe": {
      "columns": [
        {
          "name": "id: SessionId",
          "ordinal": 0,
          "type_info": "Uuid"
        },
        {
          "name": "agent_id: AgentId",
          "ordinal": 1,
          "type_info": {
            "Custom": {
              "kind": {
                "Composite": [
                  [
                    "account_id",
                    {
                      "Custom": {
                        "kind": {
                          "Composite": [
                            [
                              "label",
                              "Text"
                            ],
                            [
                              "audience",
                              "Text"
                            ]
                          ]
                        },
                        "name": "account_id"
                      }
                    }
                  ],
                  [
                    "label",
                    "Text"
                  ]
                ]
              },
              "name": "agent_id"
            }
          }
        },
        {
          "name": "classroom_id: ClassroomId",
          "ordinal": 2,
          "type_info": "Uuid"
        },
        {
          "name": "replica_id",
          "ordinal": 3,
          "type_info": "Text"
        },
        {
          "name": "started_at",
          "ordinal": 4,
          "type_info": "Timestamptz"
        }
      ],
      "nullable": [
        false,
        false,
        false,
        false,
        false
      ],
      "parameters": {
        "Left": [
          "Uuid"
        ]
      }
    },
    "query": "\n            SELECT\n                id AS \"id: SessionId\",\n                agent_id AS \"agent_id: AgentId\",\n                classroom_id AS \"classroom_id: ClassroomId\",\n                replica_id,\n                started_at\n            FROM agent_session\n            WHERE\n                id = $1\n            LIMIT 1\n            "
  },
  "c933897bae1096d9046189b27ec5f1baa4c6d8fff3637de5c2c0a0d553ddf67a": {
    "describe": {
      "columns": [
        {
          "name": "total",
          "ordinal": 0,
          "type_info": "Int8"
        }
      ],
      "nullable": [
        null
      ],
      "parameters": {
        "Left": []
      }
    },
    "query": "\n            SELECT\n                COUNT(*) AS total\n            FROM\n                agent_session\n            "
  }
}